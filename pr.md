# Выполнено ДЗ № 3
 - [X] Основное ДЗ
 - [X] Задание со *
 - [X] Задание со **

## В процессе сделано:
  - поднял через terraform сервер и на нем доккер с gitlab-ci
  - описал пайпы и окружения для приложения

### Задание со *
  - терра поднимает нужное кол-во чистых машин и прописывает их ипы для ансибла (автоматизация runners_install)
  - плейбук с ролями - настраивает машины с нуля: ставит доккер, поднимает gitlab-runner и активирует их на сервере gitlab-ci
  - через докер-композер билдится контейнер с приложением reddit, и запускается на локальной ранере (тегами можно пореопределить его создание на удаленном ранере)

### От себя
  - прописал отдельный .gitlab-ci.yml (с двойкой на конце), что бы не травить Тревиса с его проверкой синтаксила по лабе
  - на практике этот говно-код работает и поставленную задачу через докеры решает.
  - что **решительно** не нравится:
    - docker на каждом обходе стейджа компилится заново, что занимает по 1-2 минут - надо кешировать образ и запускать постоянно с кеша
      - частично решил просадив зависимости docker-compose в свой образ, гружу на регистри, потом выкачиваю
    - тесты завернул на отдельный внешний хост, где запускаю и проверяю - так себе решение..
    - при каждом запуске приложение билдится с тегом от джоба - понятное дело смысла в этом мало - тут скорее что бы поиграться..
    - ну и при запуске очередного нового контейнера, старый прибывается со всеми висящими запросами и данными - тут конечно и ХА-прокси и прочие балансовые прелести надо решать, вольюмы и тд., но это уже из другого кина.
  - но в конечном случае - приложение билдится, тегается, хранятся версии, они же запускаются в итоге на ревью-сервере
  - можно было и другие этапы так же раскидать по тегам (условиям) на прод и стейдж сервера - но посыл думаю понятен.

## PR checklist
  - [X] Выставил label gitlab-ci
  - [X] Выставил label gitlab-ci-1
